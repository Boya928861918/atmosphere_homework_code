from matplotlib import pyplot as plt
import numpy as np
from mpl_toolkits.mplot3d import Axes3D

plt.rcParams['font.sans-serif'] = ['SimHei']
plt.rcParams['axes.unicode_minus'] = False

t0 = []
for i in range(0, 20):
    t0.append(float(i+1))
t0 = np.array(t0)
x0 = [0.99, 0.95, 0.87, 0.77, 0.67, 0.56, 0.44, 0.30, 0.16, 0.01, -0.2, -0.11, 0.05, 0.16, 0.29, 0.42, 0.59, 0.73, 0.85, 0.93, 0.99]
y0 = [0.39, 0.32, 0.27, 0.22, 0.18, 0.15, 0.13, 0.12, 0.13, 0.15, 0.22, 0.32, 0.36, 0.40, 0.41, 0.42, 0.43, 0.42, 0.41, 0.40, 0.39]
mx = np.array([-0.140131831, -1.78772118E-02, -2.83590928E-02, 1.13133304E-02, -1.68938730E-02, -3.73814115E-03, -2.81535052E-02, -3.64771765E-03,  4.27441970E-02, -0.227328926, 0.506571352, 1.04346313E-03, -9.07454938E-02, 6.19385280E-02, -3.70086394E-02, 8.60960335E-02, -6.73755333E-02, 3.40646319E-03, -6.62505552E-02, 2.15956252E-02, -0.140131831])
my = np.array([-9.81184021E-02, 5.93622401E-02, -1.93305090E-02, 1.79596134E-02, 7.49217113E-03, 1.20716458E-02, 4.22118977E-03, 3.10436692E-02, -8.39588884E-03, 6.25399649E-02, 5.82359433E-02, -0.115483731, 4.36989814E-02, -5.93123697E-02, 1.35504892E-02, 5.11040958E-03, -3.39919478E-02, 1.08571453E-02, -9.43645369E-03, 2.68886685E-02, -9.81184021E-02])


l = len(x0)
def draw(x0_, y0_, mx_, my_, i_):
    t_ = np.linspace(i_, i_+1, 100)
    # y_ = (x0_[i_]-x_)**3*m_[i_-1]/(6*h_[i_])+(x_-x0_[i_-1])**3*m_[i_]/(6*h_[i_])+(y0_[i_-1]-h_[i_]**2*m_[i_-1]/6)*(x_[i_]-x_)/h_[i_]+(y0_[i_]-h_[i_]**2*m_[i_]/6)*(x_-x_[i_-1])/h_[i_]
    x_ = mx_[i_-1] * (i_+1-t_)**3 / (6) + mx_[i_] * (t_-i_)**3 / (6) + (x0_[i_]-mx_[i_]/6) * (t_-i_) + (x0_[i_-1]/-mx_[i_-1]/6) * (i_+1-t_)
    y_ = my_[i_-1] * (i_+1-t_)**3 / (6) + my_[i_] * (t_-i_)**3 / (6) + (y0_[i_]-my_[i_]/6) * (t_-i_) + (y0_[i_-1]/-my_[i_-1]/6) * (i_+1-t_)
    plt.xlabel('x')
    plt.ylabel('y')
    plt.plot(x_, y_, marker='o')
    
    plt.show

for i in range(1, l):
    draw(x0, y0, mx, my, i)
plt.plot(x0, y0)
plt.savefig('test2.png')